"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.create = exports.action = void 0;
const commander_1 = require("commander");
const supabase_1 = require("../../libs/supabase");
const action = async (name, dbpass, { token, plan = "free", region, org, }) => {
    const config = await (0, supabase_1.getRemoteEnv)();
    if (!config)
        return;
    const accessToken = token || config.access_token || "";
    const organizationId = org || (await (0, supabase_1.getOrganizations)(accessToken))?.[0]?.id;
    const regionName = region || "us-east-1";
    (0, supabase_1.createProject)({
        token: accessToken,
        name,
        dbPass: dbpass,
        organizationId,
        region: regionName,
        plan,
    });
};
exports.action = action;
exports.create = commander_1.program
    .createCommand("create")
    .description("Create a project")
    .addOption(new commander_1.Option("-t, --token <accessToken>", "AccessToken"))
    .addOption(new commander_1.Option("-p, --plan <plan>", "Plan of project"))
    .addOption(new commander_1.Option("-r, --region <region>", "Region of project"))
    .addOption(new commander_1.Option("-o, --org <org>", "Organization of project"))
    .addArgument(new commander_1.Argument("name", "Project name").argRequired())
    .addArgument(new commander_1.Argument("dbpass", "Database Password").argRequired())
    .action(exports.action);
