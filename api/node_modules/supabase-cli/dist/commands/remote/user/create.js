"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.create = exports.action = void 0;
const commander_1 = require("commander");
const supabase_1 = require("../../../libs/supabase");
const action = async (email, password, options) => {
    const url = options.url || (await (0, supabase_1.getSupabaseUrl)());
    if (!url) {
        console.error("Url unknown");
        return;
    }
    const apiKey = options.service_role || (await (0, supabase_1.getSupabaseServiceRole)());
    if (!apiKey) {
        console.error("Service role unknown");
        return;
    }
    (0, supabase_1.createUser)({
        url,
        apiKey,
        email,
        password,
    });
};
exports.action = action;
exports.create = commander_1.program
    .createCommand("create")
    .description("Create a remote user")
    .addOption(new commander_1.Option("-u, --url <url>", "Url of supabase"))
    .addOption(new commander_1.Option("-k, --service_role <service_role>", "Service role of supabase"))
    .addArgument(new commander_1.Argument("email", "User's email address").argRequired())
    .addArgument(new commander_1.Argument("password", "User Password").argRequired())
    .action(exports.action);
